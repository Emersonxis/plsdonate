-- Variáveis principais e GUI
local player = game.Players.LocalPlayer
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
local frame = Instance.new("Frame", screenGui)
local toggleEggButton = Instance.new("TextButton", frame)
local eggNameInput = Instance.new("TextBox", frame)
local toggleFarmButton = Instance.new("TextButton", frame)
local areaNameInput = Instance.new("TextBox", frame)
local chestNameInput = Instance.new("TextBox", frame) -- Novo campo para o nome do baú
local fastAutoFarmButton = Instance.new("TextButton", frame)
local closeButton = Instance.new("TextButton", frame)
local titleLabel = Instance.new("TextLabel", frame)

-- Variáveis de controle
local isBuying = false
local isFarming = false
local isFastAutoFarming = false
local isChestFarming = false -- Novo controle para farmar baús
local SelectedArea = "Hacker Portal"
local Library = require(game:GetService("ReplicatedStorage").Framework.Library)

-- Configurações da GUI
frame.Size = UDim2.new(0, 200, 0, 250) -- Aumentado para novo botão
frame.Position = UDim2.new(0.5, -100, 0.5, -125) -- Ajustado para nova posição
frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.BackgroundTransparency = 0.1

-- Título da GUI
titleLabel.Size = UDim2.new(1, 0, 0.15, 0)
titleLabel.Position = UDim2.new(0, 0, 0, 0)
titleLabel.Text = "👾FrancesS👾"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.BackgroundTransparency = 1
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 14

-- Campo para o nome do egg
eggNameInput.Size = UDim2.new(0.9, 0, 0.15, 0)
eggNameInput.Position = UDim2.new(0.05, 0, 0.15, 0)
eggNameInput.PlaceholderText = "Nome do Egg"
eggNameInput.Text = ""
eggNameInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
eggNameInput.TextColor3 = Color3.new(1, 1, 1)
eggNameInput.Font = Enum.Font.Gotham
eggNameInput.PlaceholderColor3 = Color3.fromRGB(200, 200, 200)
eggNameInput.TextSize = 10
eggNameInput.BorderSizePixel = 0

-- Botão de compra de eggs
toggleEggButton.Size = UDim2.new(0.9, 0, 0.15, 0)
toggleEggButton.Position = UDim2.new(0.05, 0, 0.3, 0)
toggleEggButton.Text = "Iniciar Compra"
toggleEggButton.BackgroundColor3 = Color3.fromRGB(50, 205, 50)
toggleEggButton.TextColor3 = Color3.new(1, 1, 1)
toggleEggButton.Font = Enum.Font.GothamBold
toggleEggButton.TextSize = 10
toggleEggButton.BorderSizePixel = 0

-- Campo para o nome da área de farm
areaNameInput.Size = UDim2.new(0.9, 0, 0.15, 0)
areaNameInput.Position = UDim2.new(0.05, 0, 0.45, 0)
areaNameInput.PlaceholderText = "Nome da Área"
areaNameInput.Text = ""
areaNameInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
areaNameInput.TextColor3 = Color3.new(1, 1, 1)
areaNameInput.Font = Enum.Font.Gotham
areaNameInput.PlaceholderColor3 = Color3.fromRGB(200, 200, 200)
areaNameInput.TextSize = 10
areaNameInput.BorderSizePixel = 0

-- Novo campo para o nome do chest
chestNameInput.Size = UDim2.new(0.9, 0, 0.15, 0)
chestNameInput.Position = UDim2.new(0.05, 0, 0.6, 0)
chestNameInput.PlaceholderText = "Nome do Chest"
chestNameInput.Text = ""
chestNameInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
chestNameInput.TextColor3 = Color3.new(1, 1, 1)
chestNameInput.Font = Enum.Font.Gotham
chestNameInput.PlaceholderColor3 = Color3.fromRGB(200, 200, 200)
chestNameInput.TextSize = 10
chestNameInput.BorderSizePixel = 0

-- Botão de farm
toggleFarmButton.Size = UDim2.new(0.9, 0, 0.15, 0)
toggleFarmButton.Position = UDim2.new(0.05, 0, 0.75, 0)
toggleFarmButton.Text = "Ativar Farm"
toggleFarmButton.BackgroundColor3 = Color3.fromRGB(50, 205, 50)
toggleFarmButton.TextColor3 = Color3.new(1, 1, 1)
toggleFarmButton.Font = Enum.Font.GothamBold
toggleFarmButton.TextSize = 10
toggleFarmButton.BorderSizePixel = 0

-- Botão de fast auto farm
fastAutoFarmButton.Size = UDim2.new(0.9, 0, 0.15, 0)
fastAutoFarmButton.Position = UDim2.new(0.05, 0, 0.9, 0)
fastAutoFarmButton.Text = "Fast Auto Farm"
fastAutoFarmButton.BackgroundColor3 = Color3.fromRGB(50, 205, 50)
fastAutoFarmButton.TextColor3 = Color3.new(1, 1, 1)
fastAutoFarmButton.Font = Enum.Font.GothamBold
fastAutoFarmButton.TextSize = 10
fastAutoFarmButton.BorderSizePixel = 0

-- Função para obter os pets equipados
local function GetMyPets()
    local returntable = {}
    local equippedPets = Library.PetCmds.GetEquipped()
    for _, v in pairs(equippedPets) do
        table.insert(returntable, v.uid)
    end
    return returntable
end

-- Função para farmar em um chest específico com todos os pets
local function FarmChest(chestID, pets)
    pcall(function()
        for _, petID in pairs(pets) do
            workspace['__ITEMS']['__REMOTES']["join coin"]:InvokeServer({[1] = chestID, [2] = {[1] = petID}})
            workspace['__ITEMS']['__REMOTES']["farm coin"]:FireServer({[1] = chestID, [2] = petID})
        end
    end)
end

-- Função para pegar chests com o nome especificado
local function GetChestsByName(chestName)
    local chests = {}
    local ListCoins = workspace.__ITEMS.__REMOTES["get coins"]:InvokeServer({})[1]
    for i, v in pairs(ListCoins) do
        if v.n == chestName then
            table.insert(chests, {index = i, name = v.n})
        end
    end
    return chests
end

-- Loop de farm para chests
local function chestFarmLoop()
    local pets = GetMyPets()
    while isChestFarming do
        local chestName = chestNameInput.Text ~= "" and chestNameInput.Text or "Giant Pixel Chest"
        local chests = GetChestsByName(chestName)
        if #chests > 0 then
            for _, chest in pairs(chests) do
                FarmChest(chest.index, pets) -- Envia todos os pets para o baú
            end
        end
        wait(0.5)
    end
end

-- Evento do botão de farm de chests
toggleFarmButton.MouseButton1Click:Connect(function()
    isChestFarming = not isChestFarming
    toggleFarmButton.Text = isChestFarming and "Desativar Chest Farm" or "Ativar Chest Farm"
    toggleFarmButton.BackgroundColor3 = isChestFarming and Color3.fromRGB(220, 20, 60) or Color3.fromRGB(50, 205, 50)

    if isChestFarming then
        spawn(chestFarmLoop)
    end
end)

-- Evento do botão de compra de eggs
toggleEggButton.MouseButton1Click:Connect(function()
    isBuying = not isBuying
    toggleEggButton.Text = isBuying and "Parar Compra" or "Iniciar Compra"
    toggleEggButton.BackgroundColor3 = isBuying and Color3.fromRGB(220, 20, 60) or Color3.fromRGB(50, 205, 50)

    if isBuying then
        local eggName = eggNameInput.Text
        local args = {
            [1] = {
                [1] = eggName,
                [2] = true
            }
        }
        workspace.__ITEMS.__REMOTES:FindFirstChild("buy egg"):InvokeServer(unpack(args))
    end
end)

-- Evento do botão de fast auto farm
fastAutoFarmButton.MouseButton1Click:Connect(function()
    isFastAutoFarming = not isFastAutoFarming
    fastAutoFarmButton.Text = isFastAutoFarming and "Desativar Fast Auto Farm" or "Ativar Fast Auto Farm"
    fastAutoFarmButton.BackgroundColor3 = isFastAutoFarming and Color3.fromRGB(220, 20, 60) or Color3.fromRGB(50, 205, 50)

    if isFastAutoFarming then
        -- Adicione a lógica do fast auto farm aqui
    end
end)

-- Botão de fechar
closeButton.Size = UDim2.new(0.1, 0, 0.1, 0)
closeButton.Position = UDim2.new(0.9, -10, 0, 5)
closeButton.Text = "X"
closeButton.BackgroundColor3 = Color3.fromRGB(255, 69, 58)
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 10
closeButton.BorderSizePixel = 0

closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Início do Auto-Collect de Orbs (manter como está)
function AutoCollectOrbs()
    while true do
        local orbs = Workspace.__ITEMS.Orbs:GetChildren()
        for _, orb in ipairs(orbs) do
            local args = {
                [1] = {
                    [1] = {
                        [1] = orb.Name
                    }
                }
            }
            pcall(function()
                workspace.__ITEMS.__REMOTES:FindFirstChild("claim orbs"):FireServer(unpack(args))
            end)
        end
        wait(0.1)
    end
end

spawn(AutoCollectOrbs) -- Iniciar a coleta de orbs
