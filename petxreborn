local player = game.Players.LocalPlayer
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
local frame = Instance.new("Frame", screenGui)
local toggleEggButton = Instance.new("TextButton", frame)
local eggNameInput = Instance.new("TextBox", frame)
local toggleFarmButton = Instance.new("TextButton", frame)
local areaNameInput = Instance.new("TextBox", frame)
local closeButton = Instance.new("TextButton", frame)
local titleLabel = Instance.new("TextLabel", frame)

-- Variáveis de controle
local isBuying = false
local isFarming = false
local SelectedArea = "Hacker Portal" -- Área padrão para farm

-- Configurações da GUI
frame.Size = UDim2.new(0, 200, 0, 250)
frame.Position = UDim2.new(0.5, -100, 0.5, -125)
frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.BackgroundTransparency = 0.1

-- Título da GUI
titleLabel.Size = UDim2.new(1, 0, 0.15, 0)
titleLabel.Position = UDim2.new(0, 0, 0, -20)
titleLabel.Text = "Auto Farm & Egg GUI"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.BackgroundTransparency = 1
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 16

-- Campo para o nome do egg
eggNameInput.Size = UDim2.new(0.9, 0, 0.15, 0)
eggNameInput.Position = UDim2.new(0.05, 0, 0.15, 0)
eggNameInput.PlaceholderText = "Nome do Egg"
eggNameInput.Text = ""
eggNameInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
eggNameInput.TextColor3 = Color3.new(1, 1, 1)
eggNameInput.Font = Enum.Font.Gotham
eggNameInput.PlaceholderColor3 = Color3.fromRGB(200, 200, 200)
eggNameInput.TextSize = 12
eggNameInput.BorderSizePixel = 0

-- Botão de compra de eggs
toggleEggButton.Size = UDim2.new(0.9, 0, 0.15, 0)
toggleEggButton.Position = UDim2.new(0.05, 0, 0.3, 0)
toggleEggButton.Text = "Iniciar Compra de Eggs"
toggleEggButton.BackgroundColor3 = Color3.fromRGB(50, 205, 50)
toggleEggButton.TextColor3 = Color3.new(1, 1, 1)
toggleEggButton.Font = Enum.Font.GothamBold
toggleEggButton.TextSize = 12
toggleEggButton.BorderSizePixel = 0

-- Campo para o nome da área de farm
areaNameInput.Size = UDim2.new(0.9, 0, 0.15, 0)
areaNameInput.Position = UDim2.new(0.05, 0, 0.5, 0)
areaNameInput.PlaceholderText = "Nome da Área"
areaNameInput.Text = ""
areaNameInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
areaNameInput.TextColor3 = Color3.new(1, 1, 1)
areaNameInput.Font = Enum.Font.Gotham
areaNameInput.PlaceholderColor3 = Color3.fromRGB(200, 200, 200)
areaNameInput.TextSize = 12
areaNameInput.BorderSizePixel = 0

-- Botão de farm
toggleFarmButton.Size = UDim2.new(0.9, 0, 0.15, 0)
toggleFarmButton.Position = UDim2.new(0.05, 0, 0.65, 0)
toggleFarmButton.Text = "Ativar Auto Farm"
toggleFarmButton.BackgroundColor3 = Color3.fromRGB(50, 205, 50)
toggleFarmButton.TextColor3 = Color3.new(1, 1, 1)
toggleFarmButton.Font = Enum.Font.GothamBold
toggleFarmButton.TextSize = 12
toggleFarmButton.BorderSizePixel = 0

-- Botão de fechar
closeButton.Size = UDim2.new(0.15, 0, 0.15, 0)
closeButton.Position = UDim2.new(0.85, 0, -0.05, 0)
closeButton.Text = "X"
closeButton.BackgroundColor3 = Color3.fromRGB(220, 20, 60)
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 14
closeButton.BorderSizePixel = 0

-- Função para comprar o egg
local function buyEgg()
    local args = {
        [1] = {
            [1] = {
                [1] = eggNameInput.Text,
                [2] = true -- Abre o egg com animação
            },
            [2] = {
                [1] = false,
                [2] = false
            }
        }
    }
    workspace.__THINGS.__REMOTES:FindFirstChild("buy egg"):InvokeServer(unpack(args))
end

-- Loop de compra de eggs
local function purchaseLoop()
    while isBuying do
        buyEgg()
        wait(0.1) -- Abertura rápida dos eggs
    end
end

-- Evento do botão de compra de eggs
toggleEggButton.MouseButton1Click:Connect(function()
    isBuying = not isBuying
    toggleEggButton.Text = isBuying and "Parar Compra de Eggs" or "Iniciar Compra de Eggs"
    toggleEggButton.BackgroundColor3 = isBuying and Color3.fromRGB(220, 20, 60) or Color3.fromRGB(50, 205, 50)

    if isBuying then
        spawn(purchaseLoop)
    end
end)

-- Função de auto farm
local function autoFarm()
    while isFarming do
        SelectedArea = areaNameInput.Text ~= "" and areaNameInput.Text or "Hacker Portal"
        local petsEquip = Library.PetCmds.GetEquipped()
        local coinsToFarm = {}

        for _, g in pairs(workspace.__THINGS.Coins:GetChildren()) do
            if g:IsA("Folder") and g:GetAttribute("Area") == SelectedArea then
                table.insert(coinsToFarm, g)
            end
        end

        for _, coin in ipairs(coinsToFarm) do
            Library.Network.Invoke("Join Coin", coin.Name, petsEquip)
            for _, pet in ipairs(petsEquip) do
                Library.Network.Fire("Farm Coin", coin.Name, pet)
            end
            repeat wait() until not workspace.__THINGS.Coins:FindFirstChild(coin.Name)
        end

        wait(1)
    end
end

-- Evento do botão de farm
toggleFarmButton.MouseButton1Click:Connect(function()
    isFarming = not isFarming
    toggleFarmButton.Text = isFarming and "Desativar Auto Farm" or "Ativar Auto Farm"
    toggleFarmButton.BackgroundColor3 = isFarming and Color3.fromRGB(220, 20, 60) or Color3.fromRGB(50, 205, 50)

    if isFarming then
        spawn(autoFarm)
    end
end)

-- Evento do botão de fechar
closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)
