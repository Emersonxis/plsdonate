-- Variáveis principais e GUI
local player = game.Players.LocalPlayer
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
local frame = Instance.new("Frame", screenGui)
local toggleEggButton = Instance.new("TextButton", frame)
local eggNameInput = Instance.new("TextBox", frame)
local toggleFarmButton = Instance.new("TextButton", frame)
local areaNameInput = Instance.new("TextBox", frame)
local closeButton = Instance.new("TextButton", frame)
local titleLabel = Instance.new("TextLabel", frame)

-- Novo botão para alternar entre enviar todos os pets ou apenas um
local togglePetModeButton = Instance.new("TextButton", frame)

-- Variáveis de controle
local isBuying = false
local isFarming = false
local SelectedArea = "Hacker Portal"
local Library = require(game:GetService("ReplicatedStorage").Framework.Library)
local sendAllPets = true -- Variável de controle para o modo de envio de pets

-- Configurações da GUI
frame.Size = UDim2.new(0, 150, 0, 150) -- Tamanho ajustado para menor
frame.Position = UDim2.new(0.5, -75, 0.5, -75) -- Centralizado
frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.BackgroundTransparency = 0.1

-- Título da GUI
titleLabel.Size = UDim2.new(1, 0, 0.15, 0) -- Tamanho ajustado
titleLabel.Position = UDim2.new(0, 0, 0, 0) -- Posição ajustada
titleLabel.Text = "👾FrancesS👾"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.BackgroundTransparency = 1
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 14 -- Tamanho do texto ajustado

-- Campo para o nome do egg
eggNameInput.Size = UDim2.new(0.9, 0, 0.15, 0) -- Tamanho ajustado
eggNameInput.Position = UDim2.new(0.05, 0, 0.15, 0) -- Posição ajustada
eggNameInput.PlaceholderText = "Nome do Egg"
eggNameInput.Text = ""
eggNameInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
eggNameInput.TextColor3 = Color3.new(1, 1, 1)
eggNameInput.Font = Enum.Font.Gotham
eggNameInput.PlaceholderColor3 = Color3.fromRGB(200, 200, 200)
eggNameInput.TextSize = 10 -- Tamanho do texto ajustado
eggNameInput.BorderSizePixel = 0

-- Botão de compra de eggs
toggleEggButton.Size = UDim2.new(0.9, 0, 0.15, 0) -- Tamanho ajustado
toggleEggButton.Position = UDim2.new(0.05, 0, 0.3, 0) -- Posição ajustada
toggleEggButton.Text = "Iniciar Compra"
toggleEggButton.BackgroundColor3 = Color3.fromRGB(50, 205, 50)
toggleEggButton.TextColor3 = Color3.new(1, 1, 1)
toggleEggButton.Font = Enum.Font.GothamBold
toggleEggButton.TextSize = 10 -- Tamanho do texto ajustado
toggleEggButton.BorderSizePixel = 0

-- Campo para o nome da área de farm
areaNameInput.Size = UDim2.new(0.9, 0, 0.15, 0) -- Tamanho ajustado
areaNameInput.Position = UDim2.new(0.05, 0, 0.45, 0) -- Posição ajustada
areaNameInput.PlaceholderText = "Nome da Área"
areaNameInput.Text = ""
areaNameInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
areaNameInput.TextColor3 = Color3.new(1, 1, 1)
areaNameInput.Font = Enum.Font.Gotham
areaNameInput.PlaceholderColor3 = Color3.fromRGB(200, 200, 200)
areaNameInput.TextSize = 10 -- Tamanho do texto ajustado
areaNameInput.BorderSizePixel = 0

-- Botão de farm
toggleFarmButton.Size = UDim2.new(0.9, 0, 0.15, 0) -- Tamanho ajustado
toggleFarmButton.Position = UDim2.new(0.05, 0, 0.6, 0) -- Posição ajustada
toggleFarmButton.Text = "Ativar Farm"
toggleFarmButton.BackgroundColor3 = Color3.fromRGB(50, 205, 50)
toggleFarmButton.TextColor3 = Color3.new(1, 1, 1)
toggleFarmButton.Font = Enum.Font.GothamBold
toggleFarmButton.TextSize = 10 -- Tamanho do texto ajustado
toggleFarmButton.BorderSizePixel = 0

-- Configuração do botão de alternância de modo de envio de pets
togglePetModeButton.Size = UDim2.new(0.9, 0, 0.15, 0)
togglePetModeButton.Position = UDim2.new(0.05, 0, 0.75, 0)
togglePetModeButton.Text = "Modo: Todos os Pets"
togglePetModeButton.BackgroundColor3 = Color3.fromRGB(100, 149, 237)
togglePetModeButton.TextColor3 = Color3.new(1, 1, 1)
togglePetModeButton.Font = Enum.Font.GothamBold
togglePetModeButton.TextSize = 10
togglePetModeButton.BorderSizePixel = 0

-- Botão de fechar a GUI
closeButton.Size = UDim2.new(0.15, 0, 0.15, 0) -- Tamanho ajustado
closeButton.Position = UDim2.new(0.85, 0, 0, 0) -- Posição ajustada para o canto
closeButton.Text = "X"
closeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 10 -- Tamanho do texto ajustado
closeButton.BorderSizePixel = 0

-- Função para alternar entre enviar todos os pets ou apenas um por breakable
togglePetModeButton.MouseButton1Click:Connect(function()
    sendAllPets = not sendAllPets
    togglePetModeButton.Text = sendAllPets and "Modo: Todos os Pets" or "Modo: Um Pet por Breakable"
end)

-- Função para fechar a GUI
closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Função para obter os pets equipados
local function GetMyPets()
    local returntable = {}
    local equippedPets = Library.PetCmds.GetEquipped()
    for _, v in pairs(equippedPets) do
        table.insert(returntable, v.uid)
    end
    return returntable
end

-- Função para farmar em um coin específico com todos os pets ou um
local function FarmCoin(CoinID, Pets)
    Library.Network.Invoke("Join Coin", CoinID, Pets)
    if sendAllPets then
        for _, pet in ipairs(Pets) do
            Library.Network.Fire("Farm Coin", CoinID, pet)
        end
    else
        Library.Network.Fire("Farm Coin", CoinID, Pets[1]) -- Envia apenas o primeiro pet
    end
end

-- Função de ativação de compra de eggs
toggleEggButton.MouseButton1Click:Connect(function()
    isBuying = not isBuying
    if isBuying then
        toggleEggButton.Text = "Parar Compra"
        spawn(function()
            while isBuying do
                local eggName = eggNameInput.Text
                Library.Network.Invoke("Buy Egg", eggName, false)
                wait(1) -- Delay entre cada compra
            end
        end)
    else
        toggleEggButton.Text = "Iniciar Compra"
    end
end)

-- Função de ativação de farm
toggleFarmButton.MouseButton1Click:Connect(function()
    isFarming = not isFarming
    if isFarming then
        toggleFarmButton.Text = "Parar Farm"
        SelectedArea = areaNameInput.Text
        spawn(function()
            while isFarming do
                local coins = Library.Network.Invoke("Get Coins")
                for _, coin in pairs(coins) do
                    if coin.a == SelectedArea then
                        local pets = GetMyPets()
                        FarmCoin(coin.b, pets)
                        wait(0.5) -- Delay entre o envio para cada coin
                    end
                end
                wait(1) -- Delay antes de verificar novamente
            end
        end)
    else
        toggleFarmButton.Text = "Ativar Farm"
    end
end)
